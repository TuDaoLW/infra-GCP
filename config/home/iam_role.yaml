---
iam_custom_roles:
  - name: management-vm-operator-role 
    role_id: managementVmOperator # The ID of the custom role (max 64 lowercase alphanumeric chars)
    title: "Management VM Operator" 
    # It will then be available for use within this project.
    project_id: adroit-nimbus-481707-i0
    description: "Grants permissions required for the management VM (bastion host, monitoring agent) to operate securely within the project. Allows OS Login access, writes logs/metrics, and reads from GCS for scripts."
    stage: GA #(ALPHA, BETA, GA, DISABLED). GA for production
    permissions:
      # OS Login related permissions
      # Note: For *users* to OS Login, they need roles like roles/compute.osLogin or roles/compute.osAdminLogin.
      # If the VM itself needs to manage other users' OS Login, consider roles/compute.instanceAdmin.v1
      # or more specific custom permissions.
      - "oslogin.users.get" 
      - "oslogin.users.getLoginProfile" 
      # "oslogin.users.update" 
      # "oslogin.sshPublicKeys.get" 
      # "oslogin.sshPublicKeys.update" 
      # For a management VM simply acting as a bastion/tooling, the more common permissions are:
      - "compute.osLogin" 
      - "compute.osLogin.updateExternalUser" 
      
      # Logging and Monitoring related permissions
      - "logging.logEntries.create" 
      - "monitoring.metricDescriptors.create" 
      - "monitoring.metricDescriptors.get" 
      - "monitoring.metricDescriptors.list" 
      - "monitoring.timeSeries.create" 

      # Cloud Storage access (e.g., for startup scripts, config files)
      - "storage.objects.get" 
      - "storage.buckets.get" 

      # Compute Engine metadata access (for self-inspection or limited infra querying)
      - "compute.instances.get" 
      - "compute.zones.get" 

      # Service Usage for checking enabled APIs
      - "serviceusage.services.get" 
      - "serviceusage.services.list" 

    extra_labels:
      application: "iam"
      role-type: "custom"

